<!DOCTYPE html>
<html lang="en">

<head>
    <style>
        /* تخصيص أزرار SweetAlert */
        
        .swal2-confirm {
            background-color: #198754 !important;
            border-radius: 5px;
        }
        
        .swal2-cancel {
            background-color: #b30b11 !important;
            border-radius: 5px;
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeepSafe</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.css')}}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css')}}">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css')}}">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Changa:wght@500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" />
    <link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <nav class="navbar navbar-expand-lg bg-light ">
        <div class="container-fluid">

            <a class="navbar-brand text-success" style="font-size: 23px;  " href="#">
                <i class="fas fa-shield-alt"></i> Keep<span style="color: darkgreen;">Safe</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item">
                        <a class="nav-link" href="{{url_for('index')}}">الصفحة الرئيسية</a>
                    </li>



                    <li class="nav-item dropdown ms-2">
                        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                  الخدمات
                </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item text-right" href="#">كشف الثغرات</a></li>
                            <li><a class="dropdown-item text-right" href="#">فحص المنافذ </a></li>
                            <li>
                                <hr class="dropdown-divider">
                            </li>
                            <li><a class="dropdown-item text-right" href="#">المزيد قريبا</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#cr7">من نحن </a>
                    </li>
                    <li class="nav-item ms-3"></li>
                    <a class="nav-link active" aria-current="page" href="#" style="  font-size: 19px;  border-bottom: 3px solid #198754;">
                            لوحة التحكم
                        </a>
                    </li>

                </ul>

            </div>


            <p class="btn btn-light" style="background-color: rgba(125, 178, 122, 0.084); margin: 2px 16px; font-size: 18px; border: 2px solid #198754; border-radius: 18px; display: flex; align-items: center;">
                <i class="fas fa-user-circle" style="font-size: 24px; margin-right: 10px;"></i> {{ current_user.email }}
            </p>
            <a href="{{ url_for('logout') }}" class="btn btn-danger" style="color: aliceblue; font-size: 16px; border: 2px solid #d907074b">تسجيل الخروج</a>



        </div>
    </nav>


    <div class="containerr">
        <div class="vid">
            <video autoplay loop muted class="back-vid">
          <source src="{{ url_for('static', filename='vids/backgrund.mp4.mp4')}}" type="video/mp4" />
        </video>
            <div class="container  text-light ">
                <!-- <h1 id="cont" class="display-4 " dir="rtl" data-aos="fade-left" data-aos-delay="300">حافظ على أمان مواقعك مع <span style="color: #1e9f62; font-size: 80px;">KeepSafe</span></h1> -->
                <h1 id="cont" class="display-4 " dir="rtl" data-aos="fade-left" data-aos-delay="300">مرحباً بك، {{ name }}!</h1>
                <p class="lead" data-aos="fade-left" data-aos-delay="600"> هيا بنا لنقم بفحص موقعك وتقيمه</p>
                <div id="startButtonContainer">
                    <!-- <button id="startButton" class="btn btn-success btn-lg" data-aos="zoom-in" data-aos-delay="2000">ابدأ الآن</button>-->
                    <button id="startScanButton" class="btn btn-success btn-lg" data-aos="zoom-in" data-aos-delay="2000">ابدأ الفحص</button>

                    <div id="scanProgress" class="mt-3"></div>
                </div>

            </div>
        </div>


    </div>

    <!-- <div class="fav" data-aos="fade-down" data-aos-delay="600">
        <div class="container">
            <h1 dir="rtl">كيف تستخدم موقعنا</h1>
            <div class="line"></div>
        </div>


    </div>
    <div class="about">
        <div class="container">
            <div class="row ">
                <div class="col-lg-7" data-aos="slide-left" data-aos-delay="500">

                    <img src="{{ url_for('static', filename='imgs/report.png')}}" alt="...">

                </div>
                <div class="col-lg-5" data-aos="fade-left" data-aos-delay="500">
                    <h5><span style="color:#198754;">الخطوة 1: </span>التسجيل وتسجيل الدخول</h5>
                    <p dir="rtl">إنشاء حساب أو تسجيل الدخول إذا كان لديك حساب بالفعل. استخدم زر "التسجيل" أو "تسجيل الدخول" في الجزء العلوي من الصفحة.</p>
                    <h5><span style="color:#198754;">الخطوة 2: </span>ادخال رابط موقعك</h5>
                    <p dir="rtl">بعد تسجيل الدخول، أدخل رابط الموقع الإلكتروني الذي ترغب في فحصه في نموذج استقبال الرابط الموجود على الصفحة الرئيسية.
                    </p>
                    <h5><span style="color:#198754;">الخطوة 3: </span>بدء الفحص</h5>
                    <p dir="rtl">اضغط على زر "ابدأ الفحص" لبدء تحليل الموقع باستخدام أداة ZAP. سيستغرق الأمر بضع دقائق بناءً على حجم الموقع.</p>
                    <h5><span style="color:#198754;">الخطوة 4: </span>مراجعة النتائج</h5>
                    <p dir="rtl">بعد اكتمال الفحص، ستظهر لك تقارير مفصلة حول الثغرات المكتشفة. يمكنك مراجعتها مباشرة على الموقع أو تنزيل التقرير كملف PDF.</p>
                </div>



            </div>
        </div>
    </div> -->

    <div class="fav" id="cr7">
        <div class="container" data-aos="fade-down" data-aos-delay="300">
            <h1 dir="rtl"> كن على اطلاع بأخر المستجدات في عالم الأمن السيبراني </h1>
            <div class="line"></div>
        </div>


        <div id="carouselExample" class="carousel slide custom-carousel" data-bs-ride="carousel">
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="{{ url_for('static', filename='imgs/slaid-1.jpg')}}" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="{{ url_for('static', filename='imgs/slaid-2.jpg')}}" class="d-block w-100" alt="...">
                </div>
                <div class="carousel-item">
                    <img src="{{ url_for('static', filename='imgs/slaid-3.jpg')}}" class="d-block w-100" alt="...">
                </div>
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>

        <div class="fav" id="cr7">
            <div class="container" data-aos="fade-down" data-aos-delay="300">
                <h1 dir="rtl">ماذا نقدم لك</h1>
                <div class="line"></div>
            </div>
            <div class="servers" id="cr7">
                <div class="container">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card" style="width: 18rem;" data-aos="fade-right" data-aos-delay="400">
                                <img src="{{ url_for('static', filename='imgs/click.png')}}" class="card-img-top" alt="...">
                                <div class="card-body">
                                    <h4>فحص تلقائي وسهل الاستخدام</h4>
                                    <p class="card-text">نوفر لك واجهة سهلة وبسيطة لإجراء الفحص، كل ما عليك هو إدخال رابط موقعك، وستقوم أدواتنا بالباقي </p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" style="width: 18rem;" data-aos="zoom-in" data-aos-delay="400">
                                <img src="{{ url_for('static', filename='imgs/web.png')}}" class="card-img-top" alt="...">
                                <div class="card-body">
                                    <h4>فحص شامل لموقعك</h4>
                                    <p class="card-text" dir="rtl">نوفر لك فحصًا شاملاً للمواقع الإلكترونية باستخدام أداة ZAP لتحديد الثغرات الأمنية المحتملة، مما يتيح لك تحسين أمان موقعك</p>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card" style="width: 18rem;" data-aos="fade-left" data-aos-delay="400">
                                <img src="{{ url_for('static', filename='imgs/reports.png')}}" class="card-img-top" alt="...">
                                <div class="card-body">
                                    <h4>تقارير مفصلة عن الثغرات</h4>
                                    <p class="card-text">نقدم تقارير مفصلة حول الثغرات المكتشفة، تتضمن وصفًا كاملاً لكل ثغرة وتأثيرها المحتمل على موقعك الإلكتروني</p>
                                </div>
                            </div>
                        </div>






                    </div>



                </div>
            </div>





            <footer class="bg-dark text-white py-4">
                <div class="container">
                    <div class="row">
                        <div class="col-md-3">
                            <a class="navbar-brand text-success" style="font-size: 23px;  " href="#">
                                <i class="fas fa-shield-alt"></i> Keep<span style="color: darkgreen;">Safe</span>
                            </a>
                        </div>
                        <div class="col-md-2">

                            <ul class="list-unstyled">

                                <li><a href="/" class="text-white">الرئيسية</a></li>

                                <li><a href="/about" class="text-white">عن الموقع</a></li>
                                <li><a href="/tools" class="text-white">أدوات الفحص</a></li>
                                <li><a href="/contact" class="text-white">تواصل معنا</a></li>
                            </ul>
                        </div>
                        <div class="col-md-3">
                            <h5>سياسات الموقع</h5>

                            <ul class="list-unstyled">
                                <li><a href="/privacy" class="text-white">سياسة الخصوصية</a></li>
                                <li><a href="/terms" class="text-white">شروط الاستخدام</a></li>
                            </ul>
                        </div>
                        <div class="col-md-3">
                            <h5>تواصل معنا</h5>

                            <p dir="rtl">البريد الإلكتروني: <a href="mailto:support@keepsafe.com" class="text-white">support@keepsafe.com</a></p>
                            <div>
                                <a href="#" class="text-white me-2">Facebook</a>
                                <a href="#" class="text-white me-2">Twitter</a>
                                <a href="#" class="text-white">LinkedIn</a>
                            </div>
                        </div>
                    </div>
                    <div class="text-center mt-3">
                        <p dir="rtl">© 2024 KeepSafe. جميع الحقوق محفوظة.</p>
                    </div>
                </div>
            </footer>





            <!--        كودات جافاسكريبت -->

            <script src="https://unpkg.com/aos@next/dist/aos.js"></script>
            <script>
                AOS.init();
            </script>

            <script src="{{ url_for('static', filename='js/main.js')}}"></script>
            <script src="{{ url_for('static', filename='js/bootstrap.js')}}"></script>
            <script src="{{ url_for('static', filename='js/jquery-3.7.1.min.js')}}"></script>
            <script src="{{ url_for('static', filename='js/popper.min.js')}}"></script>
            <script src="{{ url_for('static', filename='js/bootstrap.min.js')}}"></script>
            <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
            <script src="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.js"></script>
            <script>
                // دالة لإظهار SweetAlert لإدخال الرابط
                document.getElementById('startScanButton').addEventListener('click', function() {
                    Swal.fire({
                        title: 'أدخل رابط الموقع',
                        input: 'text',
                        inputPlaceholder: 'أدخل رابط الموقع هنا',
                        showCancelButton: true,
                        confirmButtonText: 'ابدأ الفحص',
                        cancelButtonText: 'إلغاء',
                        customClass: {
                            confirmButton: 'swal2-confirm',
                            cancelButton: 'swal2-cancel'
                        },
                        inputValidator: (value) => {
                            if (!value) {
                                return 'يجب إدخال رابط الموقع!';
                            }
                        }
                    }).then((result) => {
                        if (result.isConfirmed) {
                            const targetUrl = result.value;
                            startScan(targetUrl); // استدعاء الدالة لبدء الفحص
                        }
                    });
                });

                // دالة لبدء الفحص
                function startScan(target_url) {
                    fetch('/scan', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/x-www-form-urlencoded'
                            },
                            body: new URLSearchParams({
                                target_url: target_url
                            })
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.scan_id) {
                                Swal.fire({
                                    icon: 'info',
                                    title: '.تم بدء الفحص بنجاح! يرجى الانتظار حتى انتهاء العملية',
                                    showConfirmButton: false,
                                    allowOutsideClick: false,
                                    customClass: {
                                        confirmButton: 'swal2-confirm',
                                        cancelButton: 'swal2-cancel'
                                    }
                                });
                                checkScanProgress(data.scan_id); // متابعة الفحص
                            } else if (data.error) {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'خطأ',
                                    text: data.error,
                                    customClass: {
                                        confirmButton: 'swal2-confirm',
                                        cancelButton: 'swal2-cancel'
                                    }
                                });
                            }
                        })
                        .catch(error => {
                            Swal.fire({
                                icon: 'error',
                                title: 'خطأ',
                                text: '.حدث خطأ أثناء محاولة بدء الفحص. حاول مرة أخرى',
                                customClass: {
                                    confirmButton: 'swal2-confirm',
                                    cancelButton: 'swal2-cancel'
                                }
                            });
                            console.log('Error:', error);
                        });
                }

                // دالة لمتابعة تقدم الفحص
                function checkScanProgress(scanId) {
                    const interval = setInterval(function() {
                        fetch(`/scan_status?scan_id=${scanId}`)
                            .then(response => response.json())
                            .then(data => {
                                if (data.status < 100) {
                                    Swal.fire({
                                        title: '...الفحص قيد التقدم',
                                        html: `<strong> ${data.status}%</strong><br><progress value="${data.status}" max="100"></progress>`,
                                        showConfirmButton: false,
                                        allowOutsideClick: false,
                                        customClass: {
                                            confirmButton: 'swal2-confirm',
                                            cancelButton: 'swal2-cancel'
                                        }
                                    });
                                } else if (data.status >= 100) {
                                    clearInterval(interval);
                                    Swal.fire({
                                        icon: 'success',
                                        title: '!تم اكتمال الفحص',
                                        showConfirmButton: true,
                                        confirmButtonText: 'عرض النتائج',
                                        customClass: {
                                            confirmButton: 'swal2-confirm',
                                            cancelButton: 'swal2-cancel'

                                        }
                                    }).then(() => {
                                        window.location.href = `/results?scan_id=${scanId}`; // عرض النتائج
                                    });
                                }
                            })
                            .catch(error => {
                                Swal.fire({
                                    icon: 'error',
                                    title: 'خطأ',
                                    text: '.حدث خطأ أثناء جلب حالة الفحص. حاول مرة أخرى',
                                    customClass: {
                                        confirmButton: 'swal2-confirm',
                                        cancelButton: 'swal2-cancel'
                                    }
                                });
                                console.log('Error:', error);
                            });
                    }, 5000);
                }
            </script>

</body>

</html>